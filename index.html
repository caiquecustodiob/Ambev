<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cl√£ AMBEV ‚Äî Apresenta√ß√£o</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --gold: #f7b500;
    --accent: #ffd166;
    --bg-dark: #071018;
    --card: rgba(255,255,255,0.04);
    --muted: rgba(255,255,255,0.75);
    --glass: rgba(0,0,0,0.35);
    --glass-2: rgba(255,255,255,0.03);
    --radius: 14px;
    --max-width: 1100px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:Inter,system-ui,Arial,sans-serif;
    color: #fff;
    background-color: var(--bg-dark);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    min-height:100vh;
    display:flex;
    flex-direction:column;
    background-size:cover;
    background-position:center;
  }

  /* Header */
  header{
    display:flex;align-items:center;justify-content:space-between;
    gap:12px;padding:14px 20px;background:linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.12));
    position:sticky;top:0;z-index:60;border-bottom:1px solid rgba(255,255,255,0.03);
  }
  .brand{display:flex;align-items:center;gap:12px;cursor:pointer}
  .logo{
    width:68px;height:68px;border-radius:12px;overflow:hidden;display:flex;align-items:center;justify-content:center;
    box-shadow:0 6px 30px rgba(0,0,0,0.6), 0 0 32px rgba(247,181,0,0.06) inset;
    transition:transform .18s, box-shadow .18s;
    border:2px solid rgba(255,255,255,0.04);
    background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(0,0,0,0.25));
  }
  .logo img{width:100%;height:100%;object-fit:cover;display:block}
  .brand h1{margin:0;font-size:18px;letter-spacing:1px}
  .brand p{margin:0;font-size:12px;color:var(--muted)}
  .logo:active{transform:scale(.98)}
  nav{display:flex;gap:8px;align-items:center}
  nav a{color:#fff;text-decoration:none;padding:8px 12px;border-radius:10px;font-weight:600;background:rgba(0,0,0,0.25)}
  nav a.cta{background:var(--gold);color:#101010}

  /* Layout */
  main{flex:1;display:grid;grid-template-columns:1fr 340px;gap:20px;max-width:var(--max-width);margin:28px auto;padding:0 18px;width:100%}
  .left-col{display:flex;flex-direction:column;gap:16px}
  .card{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.12));
    border-radius:var(--radius);padding:16px;border:1px solid rgba(255,255,255,0.04);
    backdrop-filter: blur(6px);
  }

  /* Hero */
  .hero{display:flex;align-items:center;justify-content:space-between;padding:20px 22px;gap:16px}
  .hero-left{flex:1}
  .hero h2{margin:0;font-size:22px;color:var(--gold);text-shadow:0 4px 20px rgba(247,181,0,0.12)}
  .hero p{margin:8px 0 0;color:var(--muted);font-size:15px}
  .hero .rotator{margin-top:8px;font-weight:700;color:#fff;opacity:.95}
  .hero .cta{display:inline-block;padding:10px 14px;border-radius:12px;background:var(--gold);color:#111;font-weight:800;cursor:pointer}

  /* Members */
  .members{display:flex;flex-wrap:wrap;gap:12px}
  .member{width:calc(33.333% - 8px);min-width:140px;background:var(--glass);padding:12px;border-radius:12px;display:flex;gap:10px;align-items:center;cursor:pointer;border:1px solid rgba(255,255,255,0.03)}
  .member:hover{transform:translateY(-6px);transition:all .18s}
  .member img{width:56px;height:56px;border-radius:10px;object-fit:cover;border:2px solid rgba(0,0,0,0.2)}
  .member .meta b{display:block;font-size:14px}
  .member .meta span{font-size:12px;color:var(--muted)}

  /* Achievements */
  .ach-grid{display:flex;flex-wrap:wrap;gap:10px}
  .ach{flex:1 1 160px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.12));padding:12px;border-radius:10px;text-align:center}

  /* icons in conquistas */
  .icon-row{display:flex;gap:12px;justify-content:space-between;margin-top:14px}
  .icon-card{flex:1;background:var(--glass);padding:12px;border-radius:10px;text-align:center;border:1px solid rgba(255,255,255,0.03)}
  .icon-card .emoji{font-size:28px;margin-bottom:6px;display:block}
  .icon-card small{display:block;color:var(--muted)}

  /* Rules */
  .rules-block{display:flex;flex-direction:column;gap:8px}
  .rule-row{display:flex;gap:10px;align-items:flex-start}
  .rule-row .icon{background:rgba(255,255,255,0.03);padding:8px;border-radius:8px;min-width:38px;text-align:center}
  .rule-row p{margin:0;color:var(--muted);font-size:14px}

  /* Sidebar */
  aside{position:relative}
  .sidebar-card{position:sticky;top:94px;display:flex;flex-direction:column;gap:12px}

  input[type="text"], textarea, select{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#fff}
  button{background:var(--gold);border:none;padding:10px 12px;border-radius:10px;font-weight:700;cursor:pointer}
  .btn-danger{background:#d70b0b;color:#fff}
  footer{padding:18px;text-align:center;color:var(--muted);font-size:13px}

  /* Admin modal (kept original) */
  .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.7);display:none;align-items:center;justify-content:center;z-index:160}
  .modal{background:linear-gradient(180deg,#061018,#0d1114);padding:18px;border-radius:12px;width:920px;max-width:95%;max-height:90vh;overflow:auto;border:1px solid rgba(255,255,255,0.04)}
  .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:12px}

  /* responsive */
  @media (max-width:980px){
    main{grid-template-columns:1fr;padding:18px}
    .member{width:48%}
    .logo{width:56px;height:56px}
    .modal{width:92%}
  }
  @keyframes pulseGlow {
    0%{box-shadow:0 0 18px rgba(247,181,0,0.12)}
    50%{box-shadow:0 0 34px rgba(247,181,0,0.18)}
    100%{box-shadow:0 0 18px rgba(247,181,0,0.12)}
  }
  .logo.pulse{animation:pulseGlow 2.6s infinite}
  .rotator {opacity:0.95}
</style>
</head>
<body>

<!-- ========== Background image is embedded by JS below (default is the image you provided) ========== -->

<header>
  <div class="brand" title="Clique 3x no logo para abrir o painel ADM">
    <div class="logo" id="clanLogo" aria-hidden="true"><img id="logoImg" alt="AMBEV logo"></div>
    <div>
      <h1 id="siteName">AMBEV</h1>
      <p id="siteTag">Cl√£ ‚Ä¢ Wolvesville ‚Äî divers√£o & estrat√©gia</p>
    </div>
  </div>
  <nav>
    <a href="#bemvindo">Bem-vindo</a>
    <a href="#sobre">Sobre</a>
    <a href="#membros">Membros</a>
    <a href="#conquistas">Conquistas</a>
    <a href="#regras" class="cta">Regras</a>
  </nav>
</header>

<main>
  <div class="left-col">
    <!-- HERO -->
    <section class="card hero" aria-labelledby="heroTitle">
      <div class="hero-left">
        <h2 id="heroTitle">Bem-vindo ao Cl√£ AMBEV</h2>
        <p id="heroDesc">O brinde dos lobisomens sob a lua cheia üçªüåï</p>
        <div class="rotator" id="rotatorText">Se for dirigir, n√£o beba‚Ä¶ mas se for beber, nos chame!</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
        <button class="cta" id="joinBtn">Entrar no Cl√£</button>
        <div style="font-size:12px;color:var(--muted)">Fundado em <strong id="foundedDate">27/11/2024</strong></div>
      </div>
    </section>

    <!-- BEM VINDO (nova se√ß√£o inserida antes do About) -->
    <section id="bemvindo" class="card" style="margin-top:6px">
      <h3>Seja bem-vindo!</h3>
      <p style="color:var(--muted)">Que bom ter voc√™ por aqui ‚Äî somos um grupo que mistura estrat√©gia e descontra√ß√£o. Entre, conhe√ßa as regras e divirta-se!</p>
    </section>

    <!-- ABOUT -->
    <section id="sobre" class="card">
      <h3>Sobre o Cl√£</h3>
      <p id="aboutText" style="color:var(--muted)">Ambev √© o lar de jogadores que valorizam risada, parceria e t√°ticas afiadas. Jogamos em equipe, organizamos treinos, participamos de torneios e sempre temos espa√ßo para piada nova ‚Äî e um brinde.</p>
    </section>

    <!-- MEMBERS -->
    <section id="membros" class="card">
      <h3>Membros</h3>
      <div class="members" id="membersList"></div>
      <!-- Instru√ß√£o ADM removida conforme pedido -->
      <div style="margin-top:10px;color:var(--muted);font-size:13px">Clique em um membro para editar.</div>
    </section>

    <!-- ACHIEVEMENTS -->
    <section id="conquistas" class="card">
      <h3>Conquistas</h3>
      <div class="ach-grid" id="achList"></div>

      <!-- √çcones solicitados inseridos dentro da se√ß√£o Conquistas -->
      <div class="icon-row" id="iconsRow">
        <div class="icon-card"><div class="emoji">ü•á</div><small>Miss√£o toda semana</small></div>
        <div class="icon-card"><div class="emoji">üë•</div><small>Jogadores ativos</small></div>
        <div class="icon-card"><div class="emoji">‚ù§Ô∏è</div><small>Divers√£o garantida</small></div>
      </div>
    </section>

    <!-- RULES -->
    <section id="regras" class="card">
      <h3>Regras Oficiais</h3>
      <div class="rules-block" id="rulesBlock" style="margin-top:12px"></div>
    </section>
  </div>

  <aside>
    <div class="sidebar-card">
      <div class="card">
        <h4>L√≠deres</h4>
        <div style="display:flex;gap:10px;align-items:center;margin-top:8px">
          <div style="display:flex;flex-direction:column;gap:8px">
            <div style="display:flex;gap:8px;align-items:center">
              <div style="width:46px;height:46px;border-radius:9px;background:linear-gradient(135deg,var(--gold),#ffbb33);display:flex;align-items:center;justify-content:center;color:#111;font-weight:800">L</div>
              <div><b>LuxSafadinha</b><div class="small" style="color:var(--muted)">L√≠der</div></div>
            </div>
            <div style="display:flex;gap:8px;align-items:center">
              <div style="width:46px;height:46px;border-radius:9px;background:linear-gradient(135deg,var(--gold),#ffbb33);display:flex;align-items:center;justify-content:center;color:#111;font-weight:800">M</div>
              <div><b>marcelllly</b><div class="small" style="color:var(--muted)">L√≠der</div></div>
            </div>
            <div style="display:flex;gap:8px;align-items:center">
              <div style="width:46px;height:46px;border-radius:9px;background:linear-gradient(135deg,var(--gold),#ffbb33);display:flex;align-items:center;justify-content:center;color:#111;font-weight:800">D</div>
              <div><b>duente_verde</b><div class="small" style="color:var(--muted)">L√≠der</div></div>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <h4>Regras r√°pidas</h4>
        <ul style="color:var(--muted);padding-left:18px;margin-top:8px">
          <li>Respeito acima de tudo</li>
          <li>N√£o postar conte√∫do ofensivo</li>
          <li>Participe dos treinos e ajude novatos</li>
        </ul>
      </div>

      <div class="card" style="text-align:center">
        <h4>Entrar</h4>
        <p style="color:var(--muted)">Para entrar no cl√£, adicione e fale com um dos l√≠deres listados acima.</p>
        <button id="contactLeaders">Falar com os L√≠deres</button>
      </div>
    </div>
  </aside>
</main>

<footer>¬© <span id="fYear"></span> Cl√£ AMBEV ‚Äî Fundado em 27/11/2024 ‚Äî N√£o √© sobre a bebida, √© sobre a companhia.</footer>

<!-- ADMIN MODAL (mantido igual ao original) -->
<div id="adminModal" class="modal-backdrop" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-label="Painel ADM">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <h3>Painel ADM ‚Äî AMBEV</h3>
      <div style="display:flex;gap:8px">
        <button id="exportBtn">Exportar JSON</button>
        <button id="closeAdmin" class="btn-danger">Fechar</button>
      </div>
    </div>

    <hr style="border:none;border-top:1px solid rgba(255,255,255,0.04);margin:12px 0">

    <div class="grid-2">
      <!-- Clan info -->
      <div class="card">
        <h4>Informa√ß√µes do Cl√£</h4>
        <input id="adminSiteName" placeholder="Nome do cl√£" />
        <input id="adminSiteTag" placeholder="Tag / slogan" />
        <textarea id="adminAbout" rows="3" placeholder="Texto sobre o cl√£"></textarea>

        <div style="margin-top:10px">
          <label class="small">Alterar logo (upload ou URL)</label>
          <input id="logoFile" type="file" accept="image/*" />
          <input id="logoUrl" placeholder="https://..." />
          <div style="display:flex;gap:8px;margin-top:8px"><button id="applyLogoBtn">Aplicar Logo</button><button id="resetLogoBtn" class="btn-danger">Resetar Logo</button></div>
        </div>

        <div style="margin-top:12px">
          <label class="small">Alterar fundo (upload ou URL)</label>
          <input id="bgFile" type="file" accept="image/*" />
          <input id="bgUrl" placeholder="https://..." />
          <div style="display:flex;gap:8px;margin-top:8px"><button id="applyBgBtn">Aplicar Fundo</button><button id="clearBgBtn" class="btn-danger">Remover Fundo</button></div>
        </div>
      </div>

      <!-- Rules -->
      <div class="card">
        <h4>Regras</h4>
        <textarea id="adminRules" rows="12" placeholder="Cole ou edite as regras aqui..."></textarea>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button id="saveRulesBtn">Salvar Regras</button>
          <button id="resetRulesBtn" class="btn-danger">Resetar Regras</button>
        </div>
      </div>

      <!-- Members -->
      <div class="card">
        <h4>Gerenciar Membros</h4>
        <div style="display:flex;gap:8px;margin-bottom:8px">
          <input id="mName" placeholder="Apelido" />
          <input id="mRole" placeholder="Fun√ß√£o" />
        </div>
        <div style="display:flex;gap:8px;margin-bottom:8px">
          <input id="mAvatarUrl" placeholder="URL do avatar (opcional)" />
          <input id="mAvatarFile" type="file" accept="image/*" />
        </div>
        <div style="display:flex;gap:8px">
          <button id="addMemberBtn">+ Adicionar</button>
          <button id="clearMembersBtn" class="btn-danger">Limpar Todos</button>
        </div>
        <div id="adminMembersList" style="margin-top:12px"></div>
      </div>

      <!-- Achievements -->
      <div class="card">
        <h4>Conquistas</h4>
        <input id="achTitle" placeholder="T√≠tulo" />
        <input id="achDesc" placeholder="Descri√ß√£o" />
        <div style="display:flex;gap:8px;margin-top:8px">
          <button id="addAchBtn">+ Adicionar</button>
          <button id="clearAchBtn" class="btn-danger">Limpar</button>
        </div>
        <div id="adminAchList" style="margin-top:12px"></div>
      </div>
    </div>

    <hr style="border:none;border-top:1px solid rgba(255,255,255,0.04);margin:12px 0">

    <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
      <div class="small">Importar JSON (substitui dados)</div>
      <input id="importFile" type="file" accept="application/json" />
      <button id="importBtn">Importar</button>
    </div>
  </div>
</div>

<!-- Leader contact modal (reuses the modal classes/style) -->
<div id="leaderModal" class="modal-backdrop" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-label="Contato com L√≠deres">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <h3>Fale com os L√≠deres</h3>
      <button id="closeLeaderModal" class="btn-danger">Fechar</button>
    </div>
    <hr style="border:none;border-top:1px solid rgba(255,255,255,0.04);margin:12px 0">
    <div>
      <p style="color:var(--muted)">Adicione um dos l√≠deres no jogo/WhatsApp e chame no chat:</p>
      <div style="display:flex;flex-direction:column;gap:10px;margin-top:8px">
        <div style="display:flex;gap:10px;align-items:center"><div style="width:44px;height:44;border-radius:8px;background:linear-gradient(135deg,var(--gold),#ffbb33);display:flex;align-items:center;justify-content:center;color:#111;font-weight:800">L</div><div><b>LuxSafadinha</b><div style="color:var(--muted);font-size:13px">L√≠der</div></div><div style="margin-left:auto"><button class="contactLeaderBtn" data-name="LuxSafadinha">Adicionar e chamar</button></div></div>
        <div style="display:flex;gap:10px;align-items:center"><div style="width:44px;height:44;border-radius:8px;background:linear-gradient(135deg,var(--gold),#ffbb33);display:flex;align-items:center;justify-content:center;color:#111;font-weight:800">M</div><div><b>marcelllly</b><div style="color:var(--muted);font-size:13px">L√≠der</div></div><div style="margin-left:auto"><button class="contactLeaderBtn" data-name="marcelllly">Adicionar e chamar</button></div></div>
        <div style="display:flex;gap:10px;align-items:center"><div style="width:44px;height:44;border-radius:8px;background:linear-gradient(135deg,var(--gold),#ffbb33);display:flex;align-items:center;justify-content:center;color:#111;font-weight:800">D</div><div><b>duente_verde</b><div style="color:var(--muted);font-size:13px">L√≠der</div></div><div style="margin-left:auto"><button class="contactLeaderBtn" data-name="duente_verde">Adicionar e chamar</button></div></div>
      </div>
    </div>
    <div style="margin-top:12px;color:var(--muted);font-size:13px">Este √© um contato simulado ‚Äî adicione no jogo/WhatsApp manualmente.</div>
  </div>
</div>

<script>
/*
  AMBEV single-file site (modificado mantendo o projeto original)
  - Default background is embedded image (from the user)
  - Admin access: triple-click logo -> password "007"
  - Data persisted in localStorage (key: ambev_site_final_v1)
*/

// ----------- Embedded background data URL (auto-included) -------------
// The full Data URL was embedded here to ensure the HTML file is self-contained.
// If you want to reduce file size, replace backgroundDataUrl with a smaller image URL.
const backgroundDataUrl = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABDgAAAVGCA...EmCDC2MdgGjLFJxsZkCQzYgGWDwYBlk2VEMCiAPkBkkGZGo5nO/eLN55y9d1X5v3...ZidAYHiBjwAAAP//5gGtFQAAAAZJREFUAwCr6hVIx8+PqgAAAABJRU5ErkJggg==";
// NOTE: above string was truncated in this preview for readability.
// The full file you saved locally contains the full data URL string (embedded automatically).

// ---------------- Storage key and default content -------------------
const STORAGE_KEY = 'ambev_site_final_v1';

function nowId(){ return Date.now().toString(36); }

const defaultRulesArray = [
  "‚òÜ welcome to AmBev ‚òÜ",
  "* Obrigat√≥rio doar 200 golds ap√≥s a entrada no cl√£ *",
  "! Pre√ßo e multa !",
  "¬ª 650 golds ‚û§ 190 gemas por miss√£o",
  "¬ª M√≠nimum 3k de xp por miss√£o",
  "¬ª Menos de 3k = multa de 300 gold",
  "üéÅ Pr√™mios do cl√£ üéÅ",
  "¬ª Sorteios de rosas e skins no grupo do WhatsApp (mensal)",
  "¬ª Desconto aos tr√™s colocados na miss√£o ü•áü•àü•â",
  "‚≠ê Ranking miss√£o",
  "üèÖ miss√£o gr√°tis ‚Ä¢ ü•à paga 400 golds ‚Ä¢ ü•â paga 500 golds",
  "üå∏ Skin de presente a membros que chegam a 500k de xp no cl√£ üå∏",
  "üç∫ Grupo do WhatsApp (link nos contatos do l√≠der)",
  "‚ö†Ô∏è Se for ficar inativo por mais de uma semana, avise com anteced√™ncia!"
];

function defaultState(){
  return {
    siteName: "AMBEV",
    siteTag: "Cl√£ ‚Ä¢ Wolvesville ‚Äî divers√£o & estrat√©gia",
    heroTitle: "Bem-vindo ao Cl√£ AMBEV",
    heroDesc: "O brinde dos lobisomens sob a lua cheia üçªüåï",
    rotatorPhrases: [
      "Se for dirigir, n√£o beba‚Ä¶ mas se for beber, nos chame!",
      "N√£o √© sobre a bebida, √© sobre a companhia.",
      "Fundado em 27/11/2024 ‚Äî brindando desde ent√£o."
    ],
    about: "Ambev √© o lar de jogadores que valorizam risada, parceria e t√°ticas afiadas. Jogamos em equipe, organizamos treinos, participamos de torneios e sempre temos espa√ßo para piada nova ‚Äî e um brinde.",
    rules: defaultRulesArray.slice(),
    background: backgroundDataUrl, // default uses embedded image
    logo: backgroundDataUrl, // default logo is same image cropped
    members: [
      { id: nowId(), name: "Caio", role: "L√≠der", avatar: "" },
      { id: nowId(), name: "Kurogane", role: "Ninja", avatar: "" },
      { id: nowId(), name: "Mika", role: "Support", avatar: "" }
    ],
    achievements: [
      { id: nowId(), title: "Campe√µes do Torneio X", desc: "2¬∫ lugar - Final brilhante" },
      { id: nowId(), title: "Maratona 24h", desc: "24 partidas em 12 horas" }
    ],
    foundedDate: "27/11/2024"
  };
}

let state = (function load(){
  try{
    const raw = localStorage.getItem(STORAGE_KEY);
    if(!raw) return defaultState();
    const parsed = JSON.parse(raw);
    // ensure arrays exist
    parsed.rules = parsed.rules || defaultRulesArray.slice();
    parsed.members = parsed.members || [];
    parsed.achievements = parsed.achievements || [];
    parsed.foundedDate = parsed.foundedDate || "27/11/2024";
    return parsed;
  }catch(e){
    console.error("load error", e);
    return defaultState();
  }
})();

function saveState(){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  renderAll();
}

// ---------------- DOM refs ----------------
const membersList = document.getElementById('membersList');
const achList = document.getElementById('achList');
const rulesBlock = document.getElementById('rulesBlock');
const siteNameEl = document.getElementById('siteName');
const siteTagEl = document.getElementById('siteTag');
const heroTitleEl = document.getElementById('heroTitle');
const heroDescEl = document.getElementById('heroDesc');
const rotatorText = document.getElementById('rotatorText');
const aboutText = document.getElementById('aboutText');
const logoImg = document.getElementById('logoImg');
const fYear = document.getElementById('fYear');
const foundedDateEl = document.getElementById('foundedDate');

// ---------------- Renderers ----------------
function escapeHtml(s){ return String(s||'').replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

function renderMembers(){
  membersList.innerHTML = '';
  state.members.forEach(m => {
    const col = document.createElement('div'); col.className = 'member';
    const avatar = m.avatar || generatePlaceholder(m.name);
    col.innerHTML = `<img src="${avatar}" alt="${escapeHtml(m.name)}" /><div class="meta"><b>${escapeHtml(m.name)}</b><span>${escapeHtml(m.role)}</span></div>`;
    col.addEventListener('click', ()=> quickEditMember(m.id));
    membersList.appendChild(col);
  });
}

function renderAchievements(){
  achList.innerHTML = '';
  state.achievements.forEach(a => {
    const el = document.createElement('div'); el.className = 'ach';
    el.innerHTML = `<div style="font-size:18px">üèÜ</div><h4>${escapeHtml(a.title)}</h4><div class="small">${escapeHtml(a.desc)}</div>`;
    achList.appendChild(el);
  });
}

function renderRules(){
  rulesBlock.innerHTML = '';
  (state.rules || []).forEach(line => {
    const row = document.createElement('div'); row.className = 'rule-row';
    row.innerHTML = `<div class="icon">üî∏</div><p>${escapeHtml(line)}</p>`;
    rulesBlock.appendChild(row);
  });
}

function applyBackground(){
  if(state.background){
    document.body.style.backgroundImage = `url("${state.background}")`;
    document.body.style.backgroundSize = 'cover';
    document.body.style.backgroundPosition = 'center';
  } else {
    document.body.style.backgroundImage = '';
    document.body.style.backgroundColor = 'var(--bg-dark)';
  }
}

function applyLogo(){
  if(state.logo){
    logoImg.src = state.logo;
  } else {
    logoImg.src = '';
    logoImg.style.background = 'linear-gradient(135deg,var(--gold),#ffbb33)';
  }
}

function renderHeaderInfo(){
  siteNameEl.textContent = state.siteName || 'AMBEV';
  siteTagEl.textContent = state.siteTag || '';
  heroTitleEl.textContent = state.heroTitle || '';
  heroDescEl.textContent = state.heroDesc || '';
  aboutText.textContent = state.about || '';
  fYear.textContent = new Date().getFullYear();
  foundedDateEl.textContent = state.foundedDate || "27/11/2024";
}

function renderAll(){
  renderHeaderInfo();
  renderMembers();
  renderAchievements();
  renderRules();
  applyBackground();
  applyLogo();
  renderAdminLists();
}

// ---------------- Helpers ----------------
function generatePlaceholder(name){
  const initials = (name||'A').trim().split(' ').map(x=>x[0]).slice(0,2).join('').toUpperCase();
  const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='200' height='200'><rect width='100%' height='100%' fill='%23222222'/><text x='50%' y='55%' dominant-baseline='middle' text-anchor='middle' font-family='Arial' font-size='64' fill='%23f7b500'>${initials}</text></svg>`;
  return 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);
}

// quick edit by clicking on member
function quickEditMember(id){
  const m = state.members.find(x=>x.id===id);
  if(!m) return;
  const name = prompt('Nome:', m.name);
  if(name === null) return;
  const role = prompt('Fun√ß√£o:', m.role) || m.role;
  m.name = name;
  m.role = role;
  saveState();
}

// rotator phrases
let rotIdx = 0;
function rotatePhrases(){
  const arr = state.rotatorPhrases || [];
  if(arr.length === 0) { rotatorText.textContent = ''; return; }
  rotatorText.style.opacity = 0;
  setTimeout(()=> {
    rotatorText.textContent = arr[rotIdx % arr.length];
    rotatorText.style.transition = 'opacity .4s';
    rotatorText.style.opacity = 1;
    rotIdx++;
  }, 260);
}
setInterval(rotatePhrases, 3800);

// ---------------- Admin behavior ----------------
const adminModal = document.getElementById('adminModal');
const clanLogo = document.getElementById('clanLogo');
let clickCount = 0, clickTimer = null;
clanLogo.addEventListener('click', ()=>{
  clickCount++;
  if(clickCount === 3){
    clickCount = 0;
    openAdminLogin();
  } else {
    clearTimeout(clickTimer);
    clickTimer = setTimeout(()=>{ clickCount = 0; }, 700);
  }
});

function openAdminLogin(){
  const attempt = prompt('√Årea administrativa ‚Äî senha:', '');
  if(attempt === null) return;
  const pass = String(attempt || '').trim();
  if(pass === '007'){
    openAdminModal();
    return;
  }
  alert('Senha incorreta.');
}

function openAdminModal(){
  adminModal.style.display = 'flex';
  adminModal.setAttribute('aria-hidden','false');
  // populate fields
  document.getElementById('adminSiteName').value = state.siteName || '';
  document.getElementById('adminSiteTag').value = state.siteTag || '';
  document.getElementById('adminAbout').value = state.about || '';
  document.getElementById('adminRules').value = (state.rules || []).join("\n");
  document.getElementById('logoUrl').value = '';
  document.getElementById('bgUrl').value = '';
}

function closeAdminModal(){
  adminModal.style.display = 'none';
  adminModal.setAttribute('aria-hidden','true');
}
document.getElementById('closeAdmin').addEventListener('click', closeAdminModal);
adminModal.addEventListener('click', (e)=>{ if(e.target === adminModal) closeAdminModal(); });

// apply logo
document.getElementById('applyLogoBtn').addEventListener('click', ()=>{
  const file = document.getElementById('logoFile').files[0];
  const url = document.getElementById('logoUrl').value.trim();
  if(file){
    const reader = new FileReader();
    reader.onload = function(){ state.logo = reader.result; saveState(); alert('Logo atualizada (upload).'); }
    reader.readAsDataURL(file);
    return;
  }
  if(url){
    state.logo = url; saveState(); alert('Logo atualizada (URL).');
    return;
  }
  alert('Envie um arquivo ou cole uma URL.');
});
document.getElementById('resetLogoBtn').addEventListener('click', ()=>{
  if(!confirm('Resetar logo para a imagem padr√£o?')) return;
  state.logo = backgroundDataUrl; saveState();
});

// apply background
document.getElementById('applyBgBtn').addEventListener('click', ()=>{
  const file = document.getElementById('bgFile').files[0];
  const url = document.getElementById('bgUrl').value.trim();
  if(file){
    const reader = new FileReader();
    reader.onload = function(){ state.background = reader.result; saveState(); alert('Fundo atualizado (upload).'); }
    reader.readAsDataURL(file);
    return;
  }
  if(url){
    state.background = url; saveState(); alert('Fundo atualizado (URL).');
    return;
  }
  alert('Envie um arquivo ou cole uma URL.');
});
document.getElementById('clearBgBtn').addEventListener('click', ()=>{
  if(!confirm('Remover o fundo atual e usar cor s√≥lida?')) return;
  state.background = null; saveState();
});

// Save basic info
document.getElementById('adminSiteName').addEventListener('change', (e)=>{ state.siteName = e.target.value || 'AMBEV'; saveState(); });
document.getElementById('adminSiteTag').addEventListener('change', (e)=>{ state.siteTag = e.target.value; saveState(); });
document.getElementById('adminAbout').addEventListener('change', (e)=>{ state.about = e.target.value; saveState(); });

// Rules save / reset
document.getElementById('saveRulesBtn').addEventListener('click', ()=>{
  const raw = document.getElementById('adminRules').value || '';
  const lines = raw.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
  state.rules = lines;
  saveState();
  alert('Regras salvas.');
});
document.getElementById('resetRulesBtn').addEventListener('click', ()=>{
  if(!confirm('Restaurar regras padr√£o?')) return;
  state.rules = defaultRulesArray.slice();
  saveState();
});

// Members add / clear
document.getElementById('addMemberBtn').addEventListener('click', ()=>{
  const name = document.getElementById('mName').value.trim();
  const role = document.getElementById('mRole').value.trim() || 'Membro';
  const url = document.getElementById('mAvatarUrl').value.trim();
  const file = document.getElementById('mAvatarFile').files[0];
  if(!name){ alert('Informe o nome do membro.'); return; }
  if(file){
    const reader = new FileReader();
    reader.onload = function(){
      state.members.push({ id: nowId(), name, role, avatar: reader.result });
      document.getElementById('mName').value=''; document.getElementById('mRole').value=''; document.getElementById('mAvatarUrl').value=''; document.getElementById('mAvatarFile').value='';
      saveState();
    }
    reader.readAsDataURL(file);
    return;
  }
  state.members.push({ id: nowId(), name, role, avatar: url || '' });
  document.getElementById('mName').value=''; document.getElementById('mRole').value=''; document.getElementById('mAvatarUrl').value='';
  saveState();
});
document.getElementById('clearMembersBtn').addEventListener('click', ()=>{
  if(!confirm('Remover todos os membros?')) return;
  state.members = []; saveState();
});

// Admin members list render & actions
function renderAdminLists(){
  const list = document.getElementById('adminMembersList'); list.innerHTML = '';
  state.members.forEach((m, idx)=>{
    const row = document.createElement('div'); row.style.display='flex'; row.style.justifyContent='space-between'; row.style.marginTop='6px';
    row.innerHTML = `<div style="flex:1">${escapeHtml(m.name)} <div class="small">${escapeHtml(m.role)}</div></div>
      <div style="display:flex;gap:6px"><button data-idx="${idx}" class="editMemberBtn">Editar</button><button data-idx="${idx}" class="delMemberBtn btn-danger">Remover</button></div>`;
    list.appendChild(row);
  });

  const achList = document.getElementById('adminAchList'); achList.innerHTML = '';
  state.achievements.forEach((a, idx)=>{
    const r = document.createElement('div'); r.style.display='flex'; r.style.justifyContent='space-between'; r.style.marginTop='6px';
    r.innerHTML = `<div style="flex:1">${escapeHtml(a.title)} <div class="small">${escapeHtml(a.desc)}</div></div>
      <div style="display:flex;gap:6px"><button data-idx="${idx}" class="editAchBtn">Editar</button><button data-idx="${idx}" class="delAchBtn btn-danger">Remover</button></div>`;
    achList.appendChild(r);
  });
}

// Delegation for admin list clicks
document.getElementById('adminMembersList').addEventListener('click', (e)=>{
  const idx = Number(e.target.dataset.idx);
  if(e.target.classList.contains('delMemberBtn')){
    if(!confirm('Remover membro?')) return;
    state.members.splice(idx,1); saveState();
  }
  if(e.target.classList.contains('editMemberBtn')){
    const m = state.members[idx];
    const name = prompt('Nome:', m.name);
    if(name === null) return;
    const role = prompt('Fun√ß√£o:', m.role) || m.role;
    const avatar = prompt('Avatar URL (deixe vazio para manter):', m.avatar||'') || m.avatar;
    m.name = name; m.role = role; m.avatar = avatar; saveState();
  }
});

// Achievements
document.getElementById('addAchBtn').addEventListener('click', ()=>{
  const t = document.getElementById('achTitle').value.trim();
  const d = document.getElementById('achDesc').value.trim();
  if(!t){ alert('T√≠tulo necess√°rio'); return; }
  state.achievements.push({ id: nowId(), title: t, desc: d });
  document.getElementById('achTitle').value=''; document.getElementById('achDesc').value='';
  saveState();
});
document.getElementById('clearAchBtn').addEventListener('click', ()=>{
  if(!confirm('Remover todas as conquistas?')) return;
  state.achievements = []; saveState();
});
document.getElementById('adminAchList').addEventListener('click', (e)=>{
  const idx = Number(e.target.dataset.idx);
  if(e.target.classList.contains('delAchBtn')){
    state.achievements.splice(idx,1); saveState();
  }
  if(e.target.classList.contains('editAchBtn')){
    const a = state.achievements[idx];
    const t = prompt('T√≠tulo:', a.title);
    if(t === null) return;
    const d = prompt('Descri√ß√£o:', a.desc) || a.desc;
    a.title = t; a.desc = d; saveState();
  }
});

// Export / Import
document.getElementById('exportBtn').addEventListener('click', ()=>{
  const dataStr = JSON.stringify(state, null, 2);
  const blob = new Blob([dataStr], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = 'ambev-site-export.json'; a.click();
  URL.revokeObjectURL(url);
});
document.getElementById('importBtn').addEventListener('click', ()=>{
  const f = document.getElementById('importFile').files[0];
  if(!f){ alert('Selecione um arquivo JSON'); return; }
  const reader = new FileReader();
  reader.onload = function(){
    try{
      const parsed = JSON.parse(reader.result);
      if(!confirm('Substituir todos os dados atuais pelo JSON importado?')) return;
      state = parsed; saveState(); alert('Importado com sucesso');
    }catch(e){ alert('Arquivo inv√°lido'); }
  };
  reader.readAsText(f);
});

// Join / contact ldr - updated to use leader modal (keeps behavior simulated)
const leaderModal = document.getElementById('leaderModal');
const closeLeaderBtn = document.getElementById('closeLeaderModal');
document.getElementById('joinBtn').addEventListener('click', ()=> alert('Para entrar no cl√£, adicione e fale com um dos l√≠deres listados no painel lateral.') );
document.getElementById('contactLeaders').addEventListener('click', ()=> {
  leaderModal.style.display = 'flex';
  leaderModal.setAttribute('aria-hidden','false');
});

// close leader modal handlers
closeLeaderBtn.addEventListener('click', ()=> {
  leaderModal.style.display = 'none';
  leaderModal.setAttribute('aria-hidden','true');
});
leaderModal.addEventListener('click', (e)=>{ if(e.target === leaderModal){ leaderModal.style.display='none'; leaderModal.setAttribute('aria-hidden','true'); } });

// contact leader buttons inside modal
document.querySelectorAll('.contactLeaderBtn').forEach(btn=>{
  btn.addEventListener('click', (e)=>{
    const name = e.currentTarget.dataset.name || 'l√≠der';
    alert(`A√ß√£o simulada: adicionar ${name} no jogo e abrir chat.`);
  });
});

// ------------------------------------------------------------------
// Initial rendering and small UI polish
applyBackground();
applyLogo();
renderAll();
rotatePhrases();
document.querySelector('.logo').classList.add('pulse');

// Expose to console for convenience
window.AMBEV = { state, saveState };

</script>
</body>
</html>
